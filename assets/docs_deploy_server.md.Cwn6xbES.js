import{_ as s,c as i,o as a,a3 as t,a4 as e}from"./chunks/framework.CVQlUOPj.js";const y=JSON.parse('{"title":"server 部署","description":"","frontmatter":{},"headers":[],"relativePath":"docs/deploy/server.md","filePath":"docs/deploy/server.md","lastUpdated":1721099276000}'),l={name:"docs/deploy/server.md"},h=t(`<h1 id="server-部署" tabindex="-1">server 部署 <a class="header-anchor" href="#server-部署" aria-label="Permalink to &quot;server 部署&quot;">​</a></h1><p>本文档将向您展示如何独立安装 lizardcd-server 组件。 有两种选择：</p><ol><li>k8s 集群：在现有 k8s 集群上使用 helm 方式安装</li><li>本地机器：在本地机器上使用二进制文件方式安装</li></ol><h2 id="在-k8s-集群上使用-helm-安装" tabindex="-1">在 k8s 集群上使用 helm 安装 <a class="header-anchor" href="#在-k8s-集群上使用-helm-安装" aria-label="Permalink to &quot;在 k8s 集群上使用 helm 安装&quot;">​</a></h2><p>可 <a href="https://artifacthub.io/packages/helm/lizardcd/lizardcd" target="_blank" rel="noreferrer">在此</a> 查看最新的 Helm Charts 安装包。</p><p>添加仓库：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">helm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> repo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> add</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> lizardcd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://funnyfpf.github.io/lizardcd/</span></span></code></pre></div><p>安装chart：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">helm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> lizardcd-server</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> lizardcd/lizardcd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> externalEtcd.hosts=&quot;{10.0.0.2:2379,10.0.0.3:2379,10.0.0.4:2379}&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--set </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">server.enabled=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--set </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">agent.enabled=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--set </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">ui.enabled=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--set </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">etcd.enabled=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> default</span></span></code></pre></div><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>请将上述 <code>10.0.0.2:2379,10.0.0.3:2379,10.0.0.4:2379</code> 换成实际 etcd 地址</p></div><p>以上操作将在您的 Kubernetes 集群的 default 命名空间下安装 <code>lizardcd-server</code>工作负载，以及相应的<code>service</code>、<code>configmap</code>、<code>pvc</code>。</p><h2 id="卸载" tabindex="-1">卸载 <a class="header-anchor" href="#卸载" aria-label="Permalink to &quot;卸载&quot;">​</a></h2><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">helm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> uninstall</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> lizardcd-server</span></span></code></pre></div><h2 id="在本地机器上安装" tabindex="-1">在本地机器上安装 <a class="header-anchor" href="#在本地机器上安装" aria-label="Permalink to &quot;在本地机器上安装&quot;">​</a></h2><p>本地机器支持 Linux 和 Windows 系统</p><h3 id="linux" tabindex="-1">Linux <a class="header-anchor" href="#linux" aria-label="Permalink to &quot;Linux&quot;">​</a></h3><p><b>初始化 sqlite 数据库</b></p><p>下载 migrate 压缩包并解压</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tar</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> zxf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> migrate-linux-amd64-</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">versio</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">n</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.tar.gz</span></span></code></pre></div><p>将 migrate 添加到路径：</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> PATH</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$PWD/bin:$PATH</span></span></code></pre></div><p>执行以下命令初始化 sqlite 数据库</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">migrate</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">pat</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">h</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/lizardcd.db</span></span></code></pre></div><p>看到输出下图所示结果，则表示初始化成功</p><p><img src="`+e+'" alt="" data-fancybox="gallery"></p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>建议保存初始化的 admin 密码以备后续使用 ui 登录使用。</p></div><p><b>安装 lizardcd-server</b></p><p>下载 lizardcd-server 安装包并解压</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tar</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> zxf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> lizardcd-server-linux-amd64-</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">versio</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">n</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.tar.gz</span></span></code></pre></div><p>将 lizardcd-server 添加到路径：</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> PATH</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$PWD/bin:$PATH</span></span></code></pre></div><p>启动 lizardcd-server 服务：</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">lizardcd-server</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --etcd-addr</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 10.50.89.17:2379</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --http-addr=0.0.0.0:5117</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --db=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">path</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">/lizardcd.db</span></span></code></pre></div><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>上述 10.50.89.17:2379 请换成实际 etcd 地址。--db 指定上一步初始化数据库生成的 lizardcd.db 文件。</p></div><p>lizardcd-server 还能以配置文件启动，启动方法：</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">lizardcd-server</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">pat</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">h</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/lizardcd-server.yaml</span></span></code></pre></div><p>其中 <code>lizardcd-server.yaml</code> 配置文件参考 <a href="/lizardcd-doc/docs/deploy/configure/server.html">server 配置</a></p><h3 id="windows" tabindex="-1">Windows <a class="header-anchor" href="#windows" aria-label="Permalink to &quot;Windows&quot;">​</a></h3><p><b>初始化 sqlite 数据库</b></p><p>下载 <code>migrate-windows-amd64-&lt;version&gt;.tar.gz</code> 压缩包并解压到任意位置。</p><p>执行以下命令初始化 sqlite 数据库</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">migrate.exe</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">pat</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">h</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\l</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">izardcd.db</span></span></code></pre></div><p><b>安装 lizardcd-server</b></p><p>下载压缩包 <code>lizardcd-server-windows-amd64-&lt;version&gt;.tar.gz</code> 并解压到任意位置</p><p>启动 lizardcd-server 服务：</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">lizardcd-server.exe</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --etcd-addr</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 10.50.89.17:2379</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --http-addr=0.0.0.0:5117</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --db</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">pat</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">h</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\l</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">izardcd.db</span></span></code></pre></div><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>上述 10.50.89.17:2379 请换成实际 etcd 地址。--db 指定上一步初始化数据库生成的 lizardcd.db 文件。</p></div>',47),p=[h];function n(d,k,r,c,o,g){return a(),i("div",null,p)}const C=s(l,[["render",n]]);export{y as __pageData,C as default};
