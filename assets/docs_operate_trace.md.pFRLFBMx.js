import{_ as s,c as a,o as i,a3 as e}from"./chunks/framework.CVQlUOPj.js";const g=JSON.parse('{"title":"链路跟踪","description":"","frontmatter":{},"headers":[],"relativePath":"docs/operate/trace.md","filePath":"docs/operate/trace.md","lastUpdated":1721115716000}'),n={name:"docs/operate/trace.md"},t=e(`<h1 id="链路跟踪" tabindex="-1">链路跟踪 <a class="header-anchor" href="#链路跟踪" aria-label="Permalink to &quot;链路跟踪&quot;">​</a></h1><p>Lizardcd-server 和 lizardcd-agent 基于 <a href="https://go-zero.dev/" target="_blank" rel="noreferrer">go-zero</a> 框架编写，支持 <code>OpenTelemetry</code> 协议的链路跟踪功能，详见 <a href="https://go-zero.dev/docs/tutorials/monitor/index#%E9%93%BE%E8%B7%AF%E8%BF%BD%E8%B8%AA" target="_blank" rel="noreferrer">链路追踪</a>。</p><h2 id="概念" tabindex="-1">概念 <a class="header-anchor" href="#概念" aria-label="Permalink to &quot;概念&quot;">​</a></h2><p>提到链路跟踪，或者叫全链路监控，或者叫 APM(Application Performance Management)，具体含义和原理不赘述，开源方案有 skywalking、zipkin、elasticapm 等工具，商业产品有基调听云等等，但在云原生领域，也有一个 CNCF 已毕业项目 jaeger 同样发展迅速。</p><h2 id="前提条件" tabindex="-1">前提条件 <a class="header-anchor" href="#前提条件" aria-label="Permalink to &quot;前提条件&quot;">​</a></h2><p>部署 jaeger 套件，参考 <a href="https://hongyuxuan.github.io/blog/posts/2128614243/" target="_blank" rel="noreferrer">云原生链路跟踪工具Jaeger+OpenTelemetry Collector部署详解</a></p><h2 id="开启链路跟踪" tabindex="-1">开启链路跟踪 <a class="header-anchor" href="#开启链路跟踪" aria-label="Permalink to &quot;开启链路跟踪&quot;">​</a></h2><p>链路追踪支持 jaeger、zipkin，Lizardcd 使用的是 jaeger，只需要在配置中添加几行配置就可开启，无需修改任何代码，示例如下：</p><ul><li>lizardcd-server.yaml</li></ul><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">lizardServer</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Host</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0.0.0</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Port</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5117</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Timeout</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">60000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">...</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">...</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Telemetry</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  Name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">lizardcd-server</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  Endpoint</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">http://otel-collector:14278/api/traces</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  Sampler</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  Batcher</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">jaeger</span></span></code></pre></div><ul><li>lizardcd-agent.yaml</li></ul><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">LizardAgent</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">ListenOn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">0.0.0.0:5017</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Timeout</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">60000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">...</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">...</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Telemetry</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  Name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">lizardcd-agent</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  Endpoint</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">http://otel-collector:14278/api/traces</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  Sampler</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  Batcher</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">jaeger</span></span></code></pre></div><p>上述配置假定 jaeger 和 Opentelemetry Collector 已经部署完毕，其中 Opentelemetry Collector 监听在 <code>otel-collector:14278</code>。</p>`,13),l=[t];function h(p,k,r,d,o,E){return i(),a("div",null,l)}const y=s(n,[["render",h]]);export{g as __pageData,y as default};
