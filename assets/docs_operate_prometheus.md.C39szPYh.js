import{_ as s,c as i,o as a,a3 as t}from"./chunks/framework.CVQlUOPj.js";const F=JSON.parse('{"title":"指标监控","description":"","frontmatter":{},"headers":[],"relativePath":"docs/operate/prometheus.md","filePath":"docs/operate/prometheus.md","lastUpdated":1721115716000}'),e={name:"docs/operate/prometheus.md"},n=t(`<h1 id="指标监控" tabindex="-1">指标监控 <a class="header-anchor" href="#指标监控" aria-label="Permalink to &quot;指标监控&quot;">​</a></h1><p>Lizardcd-server 和 lizardcd-agent 基于 <a href="https://go-zero.dev/" target="_blank" rel="noreferrer">go-zero</a> 框架编写，支持 <a href="http://prometheus.io" target="_blank" rel="noreferrer">Prometheus</a> 格式的指标收集。详见 <a href="https://go-zero.dev/docs/tutorials/monitor/index#%E6%8C%87%E6%A0%87%E7%9B%91%E6%8E%A7" target="_blank" rel="noreferrer">指标监控</a>。</p><h2 id="开启指标收集" tabindex="-1">开启指标收集 <a class="header-anchor" href="#开启指标收集" aria-label="Permalink to &quot;开启指标收集&quot;">​</a></h2><p>只需要在配置中添加几行配置就可开启，无需修改任何代码，示例如下：</p><ul><li>lizardcd-server.yaml</li></ul><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">...</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">...</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Prometheus</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  Host</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0.0.0</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  Port</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">15117</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  Path</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/metrics</span></span></code></pre></div><ul><li>lizardcd-agent.yaml</li></ul><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">...</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">...</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">Prometheus</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  Host</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0.0.0</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  Port</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">15017</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  Path</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/metrics</span></span></code></pre></div><h2 id="访问指标监控" tabindex="-1">访问指标监控 <a class="header-anchor" href="#访问指标监控" aria-label="Permalink to &quot;访问指标监控&quot;">​</a></h2><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> curl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> http://127.0.0.1:15117/metrics</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># HELP go_gc_duration_seconds A summary of the pause duration of garbage collection cycles.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># TYPE go_gc_duration_seconds summary</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">go_gc_duration_seconds</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">{quantile=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;0&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 7.3427e-05</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">go_gc_duration_seconds</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">{quantile=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;0.25&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 7.3427e-05</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">go_gc_duration_seconds</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">{quantile=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;0.5&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 7.3427e-05</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">go_gc_duration_seconds</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">{quantile=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;0.75&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 7.3427e-05</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">go_gc_duration_seconds</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">{quantile=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;1&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 7.3427e-05</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">go_gc_duration_seconds_sum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 7.3427e-05</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">go_gc_duration_seconds_count</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># HELP go_goroutines Number of goroutines that currently exist.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># TYPE go_goroutines gauge</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">go_goroutines</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 12</span></span></code></pre></div><p>go-zero 默认的指标如下：</p><p><b>RPC Server</b></p><table tabindex="0"><thead><tr><th>指标名</th><th>Label</th><th>说明</th></tr></thead><tbody><tr><td>rpc_server_requests_duration_ms</td><td>method</td><td>Histogram，耗时统计单位为毫秒</td></tr><tr><td>rpc_server_requests_code_total</td><td>method、code</td><td>Counter，错误码统计</td></tr></tbody></table><p><b>RPC Client</b></p><table tabindex="0"><thead><tr><th>指标名</th><th>Label</th><th>说明</th></tr></thead><tbody><tr><td>rpc_client_requests_duration_ms</td><td>method</td><td>Histogram，耗时统计单位为毫秒</td></tr><tr><td>rpc_client_requests_code_total</td><td>method、code</td><td>Counter，错误码统计</td></tr></tbody></table><p><b>HTTP Server</b></p><table tabindex="0"><thead><tr><th>指标名</th><th>Label</th><th>说明</th></tr></thead><tbody><tr><td>http_server_requests_duration_ms</td><td>path</td><td>Histogram，耗时统计单位为毫秒</td></tr><tr><td>http_server_requests_code_total</td><td>path、code</td><td>Counter，错误码统计</td></tr></tbody></table>`,17),h=[n];function l(p,r,d,k,o,g){return a(),i("div",null,h)}const u=s(e,[["render",l]]);export{F as __pageData,u as default};
